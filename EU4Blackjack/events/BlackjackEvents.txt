namespace = blackjack

# Let players join blackjack

country_event = {
	id = blackjack.1
	title = blackjack.1.t
	desc = blackjack.1.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Accept joining the game
	option = {
		name = "blackjack.1a"

		hidden_effect = {

			# Player accepts or rejects game, is let in or game is full
			if = {
				limit = { NOT = { has_saved_global_event_target = blackjack_player_2_tag } }
				ROOT = {
					save_global_event_target_as = blackjack_player_2_tag
					country_event = {
						id = blackjack.2
					}
					set_country_flag = blackjack_is_player
				}
			} else_if = {
				limit = { NOT = { has_saved_global_event_target = blackjack_player_3_tag } }
				ROOT = {
					save_global_event_target_as = blackjack_player_3_tag
					country_event = {
						id = blackjack.2
					}
					set_country_flag = blackjack_is_player
				}
			} else_if = {
				limit = { NOT = { has_saved_global_event_target = blackjack_player_4_tag } }
				ROOT = {
					save_global_event_target_as = blackjack_player_4_tag
					country_event = {
						id = blackjack.2
					}
					set_country_flag = blackjack_is_player
				}
			} else = {
				country_event = {
					id = blackjack.3
				}
				set_country_flag = blackjack_not_playing
			}

			# If every player has either accepted or rejected the decision, its time to pass it off to the AI
			if = {
				limit = { blackjack_all_player_nations_accepted_or_rejected = yes }
				assign_blackjack_ais = yes
			}
		}
	}

	# Reject joining the game
	option = {
		name = "blackjack.1b"
		hidden_effect = {
			set_country_flag = blackjack_not_playing
			# If every player has either accepted or rejected the decision, its time to pass it off to the AI
			if = {
				limit = { blackjack_all_player_nations_accepted_or_rejected = yes }
				assign_blackjack_ais = yes
			}
		}
	}
}

# You have been added to the game
country_event = {
	id = blackjack.2
	title = blackjack.2.t
	desc = blackjack.2.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	option = {
		name = "blackjack.2a"
	}
}

# Game is full, try again later
country_event = {
	id = blackjack.3
	title = blackjack.3.t
	desc = blackjack.3.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	option = {
		name = "blackjack.3a"
	}
}

# Searching for players
country_event = {
	id = blackjack.4
	title = blackjack.4.t
	desc = blackjack.4.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	option = {
		name = "blackjack.4a"
	}
}

# Debug event for card shuffle
country_event = {
	id = blackjack.5
	title = blackjack.5.t
	desc = blackjack.5.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	option = {
		name = "blackjack.5a"
	}
}

# Non custom gui game state event
country_event = {
	id = blackjack.6
	title = blackjack.6.t
	desc = blackjack.6.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Refresh
	option = {
		name = "blackjack.6a"
		hidden_effect = {
			ROOT = {
				country_event = {
					id = blackjack.16
				}
			}
		}
		trigger = {
			NOT = {
				ai = yes
			}
		}
	}

	# Close
	option = {
		name = "blackjack.6b"
	}
}

# Non custom place bet p1 event
country_event = {
	id = blackjack.7
	title = blacjack.7.t
	desc = blackjack.7.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Confirm
	option = {
		name = "blackjack.7a"
		hidden_effect = {
			set_global_flag = blackjack_p1_has_bet
			blackjack_check_and_end_betting = yes
		}
	}

	# Add 1
	option = {
		name = "blackjack.7b"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 1
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 5
	option = {
		name = "blackjack.7c"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 5
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 10
	option = {
		name = "blackjack.7d"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 10
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 50
	option = {
		name = "blackjack.7e"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 50
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 100
	option = {
		name = "blackjack.7f"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 100
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 500
	option = {
		name = "blackjack.7g"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 500
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 1000
	option = {
		name = "blackjack.7h"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 1000
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}

	# Add 10000
	option = {
		name = "blackjack.7i"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p1
					value = 10000
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}
	
	# Reset
	option = {
		name = "blackjack.7j"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				set_variable = {
					which = bet_value_p1
					value = 5
				}
			}
			event_target:blackjack_player_1_tag = {
				country_event = {
					id = blackjack.11
				}
			}
		}
	}
}

# Non custom place bet p2 event
country_event = {
	id = blackjack.8
	title = blacjack.8.t
	desc = blackjack.8.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Confirm
	option = {
		name = "blackjack.8a"
		hidden_effect = {
			set_global_flag = blackjack_p2_has_bet
			blackjack_check_and_end_betting = yes
		}
	}

	# Add 1
	option = {
		name = "blackjack.8b"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 1
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 5
	option = {
		name = "blackjack.8c"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 5
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 10
	option = {
		name = "blackjack.8d"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 10
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 50
	option = {
		name = "blackjack.8e"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 50
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 100
	option = {
		name = "blackjack.8f"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 100
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 500
	option = {
		name = "blackjack.8g"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 500
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 1000
	option = {
		name = "blackjack.8h"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 1000
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}

	# Add 10000
	option = {
		name = "blackjack.8i"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 10000
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}
	
	# Reset
	option = {
		name = "blackjack.8j"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				set_variable = {
					which = bet_value_p2
					value = 5
				}
			}
			event_target:blackjack_player_2_tag = {
				country_event = {
					id = blackjack.12
				}
			}
		}
	}
}

# Non custom place bet p3 event
country_event = {
	id = blackjack.9
	title = blacjack.9.t
	desc = blackjack.9.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Confirm
	option = {
		name = "blackjack.9a"
		hidden_effect = {
			set_global_flag = blackjack_p3_has_bet
			blackjack_check_and_end_betting = yes
		}
	}

	# Add 1
	option = {
		name = "blackjack.9b"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 1
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 5
	option = {
		name = "blackjack.9c"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 5
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 10
	option = {
		name = "blackjack.9d"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 10
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 50
	option = {
		name = "blackjack.9e"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 50
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 100
	option = {
		name = "blackjack.9f"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 100
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 500
	option = {
		name = "blackjack.9g"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 500
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 1000
	option = {
		name = "blackjack.9h"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p2
					value = 1000
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}

	# Add 10000
	option = {
		name = "blackjack.9i"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p3
					value = 10000
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}
	
	# Reset
	option = {
		name = "blackjack.9j"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				set_variable = {
					which = bet_value_p3
					value = 5
				}
			}
			event_target:blackjack_player_3_tag = {
				country_event = {
					id = blackjack.13
				}
			}
		}
	}
}

# Non custom place bet p4 event
country_event = {
	id = blackjack.10
	title = blacjack.10.t
	desc = blackjack.10.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Confirm
	option = {
		name = "blackjack.10a"
		hidden_effect = {
			set_global_flag = blackjack_p4_has_bet
			blackjack_check_and_end_betting = yes
		}
	}

	# Add 1
	option = {
		name = "blackjack.10b"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 1
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 5
	option = {
		name = "blackjack.10c"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 5
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 10
	option = {
		name = "blackjack.10d"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 10
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 50
	option = {
		name = "blackjack.10e"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 50
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 100
	option = {
		name = "blackjack.10f"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 100
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 500
	option = {
		name = "blackjack.10g"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 500
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 1000
	option = {
		name = "blackjack.10h"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 1000
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}

	# Add 10000
	option = {
		name = "blackjack.10i"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				change_variable = {
					which = bet_value_p4
					value = 10000
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}
	
	# Reset
	option = {
		name = "blackjack.10j"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				set_variable = {
					which = bet_value_p4
					value = 5
				}
			}
			event_target:blackjack_player_4_tag = {
				country_event = {
					id = blackjack.14
				}
			}
		}
	}
}

# Back to betting menu events
country_event = {
	id = blackjack.11
	title = blackjack.11.t
	desc = blackjack.11.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	option = {
		name = blackjack.11a
		event_target:blackjack_player_1_tag = {
			country_event = {
				id = blackjack.7
			}
		}
	}
}

country_event = {
	id = blackjack.12
	title = blackjack.12.t
	desc = blackjack.12.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	option = {
		name = blackjack.12a
		event_target:blackjack_player_2_tag = {
			country_event = {
				id = blackjack.8
			}
		}
	}
}

country_event = {
	id = blackjack.13
	title = blackjack.13.t
	desc = blackjack.13.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	option = {
		name = blackjack.13a
		event_target:blackjack_player_3_tag = {
			country_event = {
				id = blackjack.9
			}
		}
	}
}

country_event = {
	id = blackjack.14
	title = blackjack.14.t
	desc = blackjack.14.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	option = {
		name = blackjack.14a
		event_target:blackjack_player_4_tag = {
			country_event = {
				id = blackjack.10
			}
		}
	}
}

# Options event when it is your turn
country_event = {
	id = blackjack.15
	title = blackjack.15.t
	desc = blackjack.15.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	# Hit
	option = {
		name = "blackjack.15a"
		hidden_effect = {
			log = "Player [blackjack_player_1_tag.blackjack_turn.GetValue] who is [Root.GetName] just hit!"
			#blackjack_hit = yes
			# The effect doesn't work because ???? but it works if i paste the contents here and look im so done with this im just giving up
			event_target:blackjack_player_1_tag = {
				# Fetch next card and store into export_variable
				blackjack_play_and_inc = yes
		
				# Play next card for whichever player hit
				if = {
					# Player 4's turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 4
						}
					}
					blackjack_player_4_play_card = yes
					change_variable = {
						which = blackjack_player_4_position
						value = 1
					}
				} else_if = {
					# Player 3 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 3
						}
					}
					blackjack_player_3_play_card = yes
					change_variable = {
						which = blackjack_player_3_position
						value = 1
					}
				} else_if = {
					# Player 2 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 2
						}
					}
					blackjack_player_2_play_card = yes
					change_variable = {
						which = blackjack_player_2_position
						value = 1
					}
				} else = {
					# Player 1 turn
					blackjack_player_1_play_card = yes
					change_variable = {
						which = blackjack_player_1_position
						value = 1
					}
				}
		
				event_target:blackjack_player_1_tag = {
					# Recompute player values
					# Sure you only technically need to recompute it for the one player but i cba
					blackjack_compute_hand_values = yes
					
					# If the player hit, make sure to check the status and set to bustedblackjack_p1_has_bet if > 21 or stood if == 21
					if = {
						limit = {
							OR = {
								# Player 1's turn, status is either 0 or 1
								AND = {
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_1_status
											value = 2
										}
									}
								}
								# Player 2's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_2_status
											value = 2
										}
									}
								}
								# Player 3's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_3_status
											value = 2
										}
									}
								}
								# Player 1's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
									NOT = {
										check_variable = {
											which = blackjack_player_4_status
											value = 2
										}
									}
								}
							}
						}
			
						# The player is either playing or stood
						# This means we need to check for auto-bust or auto-stand
						
						# auto-bust
						if = {
							limit = {
								blackjack_player_busted = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 2
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 2
								}
							}
						}
			
						# auto-stand
						if = {
							limit = {
								blackjack_player_stood = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 1
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 1
								}
							}
						}
					}
			
					# If all players status isn't 0, end the game
					if = {
						limit = {
							blackjack_game_over = yes
						}
						# TODO Go to dealer processing!!
						# search for the key kgh1
						# that key will have all the other dealer processing places
					}
					
					# Else navigate to the next player who's status is 0 and send them the turn event (id 17). Can repeat if other 3 are done. update the turn variable accordingly
					else = {
						# Use a while loop to find the next turn
						set_global_flag = blackjack_next_turn_while_loop_flag # Shut up cwtools shut up please shut up please please
						clr_global_flag = blackjack_next_turn_while_loop_flag
			
						while = {
							limit = {
								NOT = { has_global_flag = blackjack_next_turn_while_loop_flag }
							}
							# Increment turn and if it becomes 5, reset to 1
							change_variable = {
								which = blackjack_turn
								value = 1
							}
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 5
									}
								}
								set_variable = {
									which = blackjack_turn
									value = 1
								}
							}
							# Check if the player corresponding to this turn has a status of 0
							if = {
								limit = {
									OR = {
										# player 1 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_1_status
													value = 1
												}
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 2
												}
											}
										}
										# player 2 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_2_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 2
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 3
												}
											}
										}
										# player 3 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_3_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 3
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 4
												}
											}
										}
										# player 4 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_4_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 4
											}
										}
									}
								}
								set_global_flag = blackjack_next_turn_while_loop_flag
							}
						}
						clr_global_flag = blackjack_next_turn_while_loop_flag

						# Fire the helper event
						event_target:blackjack_player_1_tag = {
							country_event = {
								id = blackjack.17
							}
						}
					}
				}
			}
		}
		# Optimal AI
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					blackjack_optimal_move_stand = yes
					blackjack_optimal_move_double_down = yes
					blackjack_optimal_move_surrender = yes
				}
			}
		}
	}

	# Stand
	option = {
		name = "blackjack.15b"
		hidden_effect = {
			log = "Player [blackjack_player_1_tag.blackjack_turn.GetValue] who is [Root.GetName] just stood!"
			event_target:blackjack_player_1_tag = {
				# Set status to stood
				if = {
					# Player 4's turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 4
						}
					}
					set_variable = {
						which = blackjack_player_4_status
						value = 1
					}
				} else_if = {
					# Player 3 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 3
						}
					}
					set_variable = {
						which = blackjack_player_3_status
						value = 1
					}
				} else_if = {
					# Player 2 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 2
						}
					}
					set_variable = {
						which = blackjack_player_2_status
						value = 1
					}
				} else = {
					set_variable = {
						which = blackjack_player_1_status
						value = 1
					}
				}
				
				# Then advance turn
				event_target:blackjack_player_1_tag = {
					# Recompute player values
					# Sure you only technically need to recompute it for the one player but i cba
					blackjack_compute_hand_values = yes
					
					# If the player hit, make sure to check the status and set to bustedblackjack_p1_has_bet if > 21 or stood if == 21
					if = {
						limit = {
							OR = {
								# Player 1's turn, status is either 0 or 1
								AND = {
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_1_status
											value = 2
										}
									}
								}
								# Player 2's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_2_status
											value = 2
										}
									}
								}
								# Player 3's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_3_status
											value = 2
										}
									}
								}
								# Player 1's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
									NOT = {
										check_variable = {
											which = blackjack_player_4_status
											value = 2
										}
									}
								}
							}
						}
			
						# The player is either playing or stood
						# This means we need to check for auto-bust or auto-stand
						
						# auto-bust
						if = {
							limit = {
								blackjack_player_busted = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 2
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 2
								}
							}
						}
			
						# auto-stand
						if = {
							limit = {
								blackjack_player_stood = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 1
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 1
								}
							}
						}
					}
			
					# If all players status isn't 0, end the game
					if = {
						limit = {
							blackjack_game_over = yes
						}
						# TODO Go to dealer processing!!
						# search for the key kgh1
						# that key will have all the other dealer processing places
					}
					
					# Else navigate to the next player who's status is 0 and send them the turn event (id 17). Can repeat if other 3 are done. update the turn variable accordingly
					else = {
						# Use a while loop to find the next turn
						set_global_flag = blackjack_next_turn_while_loop_flag # Shut up cwtools shut up please shut up please please
						clr_global_flag = blackjack_next_turn_while_loop_flag
			
						while = {
							limit = {
								NOT = { has_global_flag = blackjack_next_turn_while_loop_flag }
							}
							# Increment turn and if it becomes 5, reset to 1
							change_variable = {
								which = blackjack_turn
								value = 1
							}
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 5
									}
								}
								set_variable = {
									which = blackjack_turn
									value = 1
								}
							}
							# Check if the player corresponding to this turn has a status of 0
							if = {
								limit = {
									OR = {
										# player 1 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_1_status
													value = 1
												}
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 2
												}
											}
										}
										# player 2 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_2_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 2
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 3
												}
											}
										}
										# player 3 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_3_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 3
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 4
												}
											}
										}
										# player 4 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_4_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 4
											}
										}
									}
								}
								set_global_flag = blackjack_next_turn_while_loop_flag
							}
						}
						clr_global_flag = blackjack_next_turn_while_loop_flag
			
						# Fire the helper event
						event_target:blackjack_player_1_tag = {
							country_event = {
								id = blackjack.17
							}
						}
					}
				}
			}
		}
		# Optimal AI
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					blackjack_optimal_move_hit = yes
					blackjack_optimal_move_double_down = yes
					blackjack_optimal_move_surrender = yes
				}
			}
		}
	}

	# Double Down
	option = {
		name = "blackjack.15c"
		hidden_effect = {
			log = "Player [blackjack_player_1_tag.blackjack_turn.GetValue] who is [Root.GetName] just doubled down!"
			event_target:blackjack_player_1_tag = {
				# Double bet and set status to stood
				if = {
					# Player 4's turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 4
						}
					}
					set_variable = {
						which = blackjack_player_4_status
						value = 1
					}
					multiply_variable = {
						which = bet_value_p4
						value = 2
					}
				} else_if = {
					# Player 3 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 3
						}
					}
					set_variable = {
						which = blackjack_player_3_status
						value = 1
					}
					multiply_variable = {
						which = bet_value_p3
						value = 2
					}
				} else_if = {
					# Player 2 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 2
						}
					}
					set_variable = {
						which = blackjack_player_2_status
						value = 1
					}
					multiply_variable = {
						which = bet_value_p2
						value = 2
					}
				} else = {
					set_variable = {
						which = blackjack_player_1_status
						value = 1
					}
					multiply_variable = {
						which = bet_value_p1
						value = 2
					}
				}
				
				# Then just hit like normal
				event_target:blackjack_player_1_tag = {
					# Fetch next card and store into export_variable
					blackjack_play_and_inc = yes
			
					# Play next card for whichever player hit
					if = {
						# Player 4's turn
						limit = {
							check_variable = {
								which = blackjack_turn
								value = 4
							}
						}
						blackjack_player_4_play_card = yes
						change_variable = {
							which = blackjack_player_4_position
							value = 1
						}
					} else_if = {
						# Player 3 turn
						limit = {
							check_variable = {
								which = blackjack_turn
								value = 3
							}
						}
						blackjack_player_3_play_card = yes
						change_variable = {
							which = blackjack_player_3_position
							value = 1
						}
					} else_if = {
						# Player 2 turn
						limit = {
							check_variable = {
								which = blackjack_turn
								value = 2
							}
						}
						blackjack_player_2_play_card = yes
						change_variable = {
							which = blackjack_player_2_position
							value = 1
						}
					} else = {
						# Player 1 turn
						blackjack_player_1_play_card = yes
						change_variable = {
							which = blackjack_player_1_position
							value = 1
						}
					}
			
					event_target:blackjack_player_1_tag = {
						# Recompute player values
						# Sure you only technically need to recompute it for the one player but i cba
						blackjack_compute_hand_values = yes
						
						# If the player hit, make sure to check the status and set to bustedblackjack_p1_has_bet if > 21 or stood if == 21
						if = {
							limit = {
								OR = {
									# Player 1's turn, status is either 0 or 1
									AND = {
										NOT = {
											check_variable = {
												which = blackjack_turn
												value = 2
											}
										}
										NOT = {
											check_variable = {
												which = blackjack_player_1_status
												value = 2
											}
										}
									}
									# Player 2's turn, status is either 0 or 1
									AND = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
										NOT = {
											check_variable = {
												which = blackjack_turn
												value = 3
											}
										}
										NOT = {
											check_variable = {
												which = blackjack_player_2_status
												value = 2
											}
										}
									}
									# Player 3's turn, status is either 0 or 1
									AND = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
										NOT = {
											check_variable = {
												which = blackjack_turn
												value = 4
											}
										}
										NOT = {
											check_variable = {
												which = blackjack_player_3_status
												value = 2
											}
										}
									}
									# Player 1's turn, status is either 0 or 1
									AND = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
										NOT = {
											check_variable = {
												which = blackjack_player_4_status
												value = 2
											}
										}
									}
								}
							}
				
							# The player is either playing or stood
							# This means we need to check for auto-bust or auto-stand
							
							# auto-bust
							if = {
								limit = {
									blackjack_player_busted = yes
								}
								# See who's turn it is and assign them bust
								if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
									}
									set_variable = {
										which = blackjack_player_4_status
										value = 2
									}
								} else_if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
									}
									set_variable = {
										which = blackjack_player_3_status
										value = 2
									}
								} else_if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
									}
									set_variable = {
										which = blackjack_player_2_status
										value = 2
									}
								} else = {
									set_variable = {
										which = blackjack_player_1_status
										value = 2
									}
								}
							}
				
							# auto-stand
							if = {
								limit = {
									blackjack_player_stood = yes
								}
								# See who's turn it is and assign them bust
								if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
									}
									set_variable = {
										which = blackjack_player_4_status
										value = 1
									}
								} else_if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
									}
									set_variable = {
										which = blackjack_player_3_status
										value = 1
									}
								} else_if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
									}
									set_variable = {
										which = blackjack_player_2_status
										value = 1
									}
								} else = {
									set_variable = {
										which = blackjack_player_1_status
										value = 1
									}
								}
							}
						}
				
						# If all players status isn't 0, end the game
						if = {
							limit = {
								blackjack_game_over = yes
							}
							# TODO Go to dealer processing!!
							# search for the key kgh1
							# that key will have all the other dealer processing places
						}
						
						# Else navigate to the next player who's status is 0 and send them the turn event (id 17). Can repeat if other 3 are done. update the turn variable accordingly
						else = {
							# Use a while loop to find the next turn
							set_global_flag = blackjack_next_turn_while_loop_flag # Shut up cwtools shut up please shut up please please
							clr_global_flag = blackjack_next_turn_while_loop_flag
				
							while = {
								limit = {
									NOT = { has_global_flag = blackjack_next_turn_while_loop_flag }
								}
								# Increment turn and if it becomes 5, reset to 1
								change_variable = {
									which = blackjack_turn
									value = 1
								}
								if = {
									limit = {
										check_variable = {
											which = blackjack_turn
											value = 5
										}
									}
									set_variable = {
										which = blackjack_turn
										value = 1
									}
								}
								# Check if the player corresponding to this turn has a status of 0
								if = {
									limit = {
										OR = {
											# player 1 turn, status of 0
											AND = {
												NOT = {
													check_variable = {
														which = blackjack_player_1_status
														value = 1
													}
												}
												NOT = {
													check_variable = {
														which = blackjack_turn
														value = 2
													}
												}
											}
											# player 2 turn, status of 0
											AND = {
												NOT = {
													check_variable = {
														which = blackjack_player_2_status
														value = 1
													}
												}
												check_variable = {
													which = blackjack_turn
													value = 2
												}
												NOT = {
													check_variable = {
														which = blackjack_turn
														value = 3
													}
												}
											}
											# player 3 turn, status of 0
											AND = {
												NOT = {
													check_variable = {
														which = blackjack_player_3_status
														value = 1
													}
												}
												check_variable = {
													which = blackjack_turn
													value = 3
												}
												NOT = {
													check_variable = {
														which = blackjack_turn
														value = 4
													}
												}
											}
											# player 4 turn, status of 0
											AND = {
												NOT = {
													check_variable = {
														which = blackjack_player_4_status
														value = 1
													}
												}
												check_variable = {
													which = blackjack_turn
													value = 4
												}
											}
										}
									}
									set_global_flag = blackjack_next_turn_while_loop_flag
								}
							}
							clr_global_flag = blackjack_next_turn_while_loop_flag
				
							# Fire the helper event
							event_target:blackjack_player_1_tag = {
								country_event = {
									id = blackjack.17
								}
							}
						}
					}
				}
			}
		}
		# Optimal AI
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					blackjack_optimal_move_hit = yes
					blackjack_optimal_move_stand = yes
					blackjack_optimal_move_surrender = yes
				}
			}
		}
	}

	# Surrender
	option = {
		name = "blackjack.15d"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				log = "Player [blackjack_player_1_tag.blackjack_turn.GetValue] who is [Root.GetName] just surrendered!"
				# Halve the bet and set status to surrendered
				if = {
					# Player 4's turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 4
						}
					}
					set_variable = {
						which = blackjack_player_4_status
						value = 3
					}
					divide_variable = {
						which = bet_value_p4
						value = 2
					}
				} else_if = {
					# Player 3 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 3
						}
					}
					set_variable = {
						which = blackjack_player_3_status
						value = 3
					}
					divide_variable = {
						which = bet_value_p3
						value = 2
					}
				} else_if = {
					# Player 2 turn
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 2
						}
					}
					set_variable = {
						which = blackjack_player_2_status
						value = 3
					}
					divide_variable = {
						which = bet_value_p2
						value = 2
					}
				} else = {
					set_variable = {
						which = blackjack_player_1_status
						value = 3
					}
					divide_variable = {
						which = bet_value_p1
						value = 2
					}
				}
				
				# Then advance turn
				event_target:blackjack_player_1_tag = {
					# Recompute player values
					# Sure you only technically need to recompute it for the one player but i cba
					blackjack_compute_hand_values = yes
					
					# If the player hit, make sure to check the status and set to bustedblackjack_p1_has_bet if > 21 or stood if == 21
					if = {
						limit = {
							OR = {
								# Player 1's turn, status is either 0 or 1
								AND = {
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 2
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_1_status
											value = 2
										}
									}
								}
								# Player 2's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 3
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_2_status
											value = 2
										}
									}
								}
								# Player 3's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
									NOT = {
										check_variable = {
											which = blackjack_turn
											value = 4
										}
									}
									NOT = {
										check_variable = {
											which = blackjack_player_3_status
											value = 2
										}
									}
								}
								# Player 1's turn, status is either 0 or 1
								AND = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
									NOT = {
										check_variable = {
											which = blackjack_player_4_status
											value = 2
										}
									}
								}
							}
						}
			
						# The player is either playing or stood
						# This means we need to check for auto-bust or auto-stand
						
						# auto-bust
						if = {
							limit = {
								blackjack_player_busted = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 2
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 2
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 2
								}
							}
						}
			
						# auto-stand
						if = {
							limit = {
								blackjack_player_stood = yes
							}
							# See who's turn it is and assign them bust
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 4
									}
								}
								set_variable = {
									which = blackjack_player_4_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 3
									}
								}
								set_variable = {
									which = blackjack_player_3_status
									value = 1
								}
							} else_if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 2
									}
								}
								set_variable = {
									which = blackjack_player_2_status
									value = 1
								}
							} else = {
								set_variable = {
									which = blackjack_player_1_status
									value = 1
								}
							}
						}
					}
			
					# If all players status isn't 0, end the game
					if = {
						limit = {
							blackjack_game_over = yes
						}
						# TODO Go to dealer processing!!
						# search for the key kgh1
						# that key will have all the other dealer processing places
					}
					
					# Else navigate to the next player who's status is 0 and send them the turn event (id 17). Can repeat if other 3 are done. update the turn variable accordingly
					else = {
						# Use a while loop to find the next turn
						set_global_flag = blackjack_next_turn_while_loop_flag # Shut up cwtools shut up please shut up please please
						clr_global_flag = blackjack_next_turn_while_loop_flag
			
						while = {
							limit = {
								NOT = { has_global_flag = blackjack_next_turn_while_loop_flag }
							}
							# Increment turn and if it becomes 5, reset to 1
							change_variable = {
								which = blackjack_turn
								value = 1
							}
							if = {
								limit = {
									check_variable = {
										which = blackjack_turn
										value = 5
									}
								}
								set_variable = {
									which = blackjack_turn
									value = 1
								}
							}
							# Check if the player corresponding to this turn has a status of 0
							if = {
								limit = {
									OR = {
										# player 1 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_1_status
													value = 1
												}
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 2
												}
											}
										}
										# player 2 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_2_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 2
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 3
												}
											}
										}
										# player 3 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_3_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 3
											}
											NOT = {
												check_variable = {
													which = blackjack_turn
													value = 4
												}
											}
										}
										# player 4 turn, status of 0
										AND = {
											NOT = {
												check_variable = {
													which = blackjack_player_4_status
													value = 1
												}
											}
											check_variable = {
												which = blackjack_turn
												value = 4
											}
										}
									}
								}
								set_global_flag = blackjack_next_turn_while_loop_flag
							}
						}
						clr_global_flag = blackjack_next_turn_while_loop_flag
			
						# Fire the helper event
						event_target:blackjack_player_1_tag = {
							country_event = {
								id = blackjack.17
							}
						}
					}
				}
			}
		}
		# Optimal AI
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					blackjack_optimal_move_hit = yes
					blackjack_optimal_move_stand = yes
					blackjack_optimal_move_double_down = yes
				}
			}
		}
	}
}

# Refresh game screen hidden event
country_event = {
	id = blackjack.16
	title = blackjack.16.t
	desc = blackjack.16.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	option = {
		name = blackjack.16a
		ROOT = {
			country_event = {
				id = blackjack.6
			}
		}
	}
}

# Options event part 2
country_event = {
	id = blackjack.17
	title = blackjack.17.t
	desc = blackjack.17.d
	picture = TRADE_GOODS_eventPicture

	hidden = yes

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			# Compute optimal moves
			blackjack_player_1_optimal_move = yes
			blackjack_player_2_optimal_move = yes
			blackjack_player_3_optimal_move = yes
			blackjack_player_4_optimal_move = yes

			# DELETE THESE LOGGING LINES
			if = {
				limit = {
					blackjack_optimal_move_hit = yes
				}
				log = "Optimal move: hit"
			}
			if = {
				limit = {
					blackjack_optimal_move_stand = yes
				}
				log = "Optimal move: stand"
			}
			if = {
				limit = {
					blackjack_optimal_move_double_down = yes
				}
				log = "Optimal move: double"
			}
			if = {
				limit = {
					blackjack_optimal_move_surrender = yes
				}
				log = "Optimal move: surrender"
			}
		}
	}

	option = {
		name = "blackjack.17a"
		hidden_effect = {
			event_target:blackjack_player_1_tag = {
				if = {
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 4
						}
					}
					event_target:blackjack_player_4_tag = {
						country_event = {
							id = blackjack.15
						}
					}
				} else_if = {
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 3
						}
					}
					event_target:blackjack_player_3_tag = {
						country_event = {
							id = blackjack.15
						}
					}
				} else_if = {
					limit = {
						check_variable = {
							which = blackjack_turn
							value = 2
						}
					}
					event_target:blackjack_player_2_tag = {
						country_event = {
							id = blackjack.15
						}
					}
				} else = {
					event_target:blackjack_player_1_tag = {
						country_event = {
							id = blackjack.15
						}
					}
				}
			}
		}
	}
}